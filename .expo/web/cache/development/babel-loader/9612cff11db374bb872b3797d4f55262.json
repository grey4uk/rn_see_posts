{"ast":null,"code":"import _defineProperty from \"@babel/runtime/helpers/defineProperty\";\nimport _regeneratorRuntime from \"@babel/runtime/regenerator\";\nimport _slicedToArray from \"@babel/runtime/helpers/slicedToArray\";\nvar _jsxFileName = \"C:\\\\Users\\\\1\\\\Documents\\\\goit_hw\\\\REACT\\\\native_project\\\\global_project\\\\screens\\\\AuthScreen.js\";\n\nfunction ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); if (enumerableOnly) symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; }); keys.push.apply(keys, symbols); } return keys; }\n\nfunction _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { ownKeys(Object(source), true).forEach(function (key) { _defineProperty(target, key, source[key]); }); } else if (Object.getOwnPropertyDescriptors) { Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)); } else { ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } } return target; }\n\nimport React, { useState, useEffect } from \"react\";\nimport StyleSheet from \"react-native-web/dist/exports/StyleSheet\";\nimport View from \"react-native-web/dist/exports/View\";\nimport TextInput from \"react-native-web/dist/exports/TextInput\";\nimport TouchableWithoutFeedback from \"react-native-web/dist/exports/TouchableWithoutFeedback\";\nimport KeyboardAvoidingView from \"react-native-web/dist/exports/KeyboardAvoidingView\";\nimport Platform from \"react-native-web/dist/exports/Platform\";\nimport Keyboard from \"react-native-web/dist/exports/Keyboard\";\nimport Image from \"react-native-web/dist/exports/Image\";\nimport ImageBackground from \"react-native-web/dist/exports/ImageBackground\";\nimport TouchableOpacity from \"react-native-web/dist/exports/TouchableOpacity\";\nimport Text from \"react-native-web/dist/exports/Text\";\nimport { auth, storage } from \"../firebase/config\";\nimport * as ImagePicker from \"expo-image-picker\";\nimport * as Permissions from \"expo-permissions\";\nvar initialState = {\n  email: \"\",\n  password: \"\",\n  displayName: \"\"\n};\nexport var AuthScreen = function AuthScreen() {\n  var _useState = useState(initialState),\n      _useState2 = _slicedToArray(_useState, 2),\n      state = _useState2[0],\n      setState = _useState2[1];\n\n  var _useState3 = useState(null),\n      _useState4 = _slicedToArray(_useState3, 2),\n      message = _useState4[0],\n      setmessage = _useState4[1];\n\n  var _useState5 = useState(false),\n      _useState6 = _slicedToArray(_useState5, 2),\n      isRegister = _useState6[0],\n      setIsRegister = _useState6[1];\n\n  var _useState7 = useState(\"\"),\n      _useState8 = _slicedToArray(_useState7, 2),\n      avatar = _useState8[0],\n      setAvatar = _useState8[1];\n\n  useEffect(function () {\n    getPermissionAsync();\n  }, []);\n\n  var currentUser = function currentUser() {\n    var currentUser;\n    return _regeneratorRuntime.async(function currentUser$(_context) {\n      while (1) {\n        switch (_context.prev = _context.next) {\n          case 0:\n            _context.next = 2;\n            return _regeneratorRuntime.awrap(auth.currentUser);\n\n          case 2:\n            currentUser = _context.sent;\n            console.log('currentUser', currentUser);\n\n          case 4:\n          case \"end\":\n            return _context.stop();\n        }\n      }\n    }, null, null, null, Promise);\n  };\n\n  var getPermissionAsync = function getPermissionAsync() {\n    var _await$Permissions$as, status;\n\n    return _regeneratorRuntime.async(function getPermissionAsync$(_context2) {\n      while (1) {\n        switch (_context2.prev = _context2.next) {\n          case 0:\n            _context2.next = 2;\n            return _regeneratorRuntime.awrap(Permissions.askAsync(Permissions.CAMERA_ROLL));\n\n          case 2:\n            _await$Permissions$as = _context2.sent;\n            status = _await$Permissions$as.status;\n\n            if (status !== \"granted\") {\n              alert(\"Sorry, we need camera roll permissions to make this work!\");\n            }\n\n          case 5:\n          case \"end\":\n            return _context2.stop();\n        }\n      }\n    }, null, null, null, Promise);\n  };\n\n  var uploadAvatar = function uploadAvatar(photo) {\n    var response, file, uniqueId, url;\n    return _regeneratorRuntime.async(function uploadAvatar$(_context3) {\n      while (1) {\n        switch (_context3.prev = _context3.next) {\n          case 0:\n            if (!photo) {\n              _context3.next = 16;\n              break;\n            }\n\n            _context3.next = 3;\n            return _regeneratorRuntime.awrap(fetch(photo));\n\n          case 3:\n            response = _context3.sent;\n            _context3.next = 6;\n            return _regeneratorRuntime.awrap(response.blob());\n\n          case 6:\n            file = _context3.sent;\n            uniqueId = Date.now().toString();\n            _context3.next = 10;\n            return _regeneratorRuntime.awrap(storage.ref(\"avatar/\" + uniqueId).put(file));\n\n          case 10:\n            _context3.next = 12;\n            return _regeneratorRuntime.awrap(storage.ref(\"avatar\").child(uniqueId).getDownloadURL());\n\n          case 12:\n            url = _context3.sent;\n            setAvatar(url);\n            _context3.next = 17;\n            break;\n\n          case 16:\n            Alert.alert(\"No avatar\");\n\n          case 17:\n          case \"end\":\n            return _context3.stop();\n        }\n      }\n    }, null, null, null, Promise);\n  };\n\n  var takePhoto = function takePhoto() {\n    var result;\n    return _regeneratorRuntime.async(function takePhoto$(_context4) {\n      while (1) {\n        switch (_context4.prev = _context4.next) {\n          case 0:\n            _context4.next = 2;\n            return _regeneratorRuntime.awrap(ImagePicker.launchImageLibraryAsync({\n              mediaTypes: ImagePicker.MediaTypeOptions.All,\n              allowsEditing: true,\n              aspect: [4, 3],\n              quality: 1\n            }));\n\n          case 2:\n            result = _context4.sent;\n            setAvatar(result.uri);\n\n          case 4:\n          case \"end\":\n            return _context4.stop();\n        }\n      }\n    }, null, null, null, Promise);\n  };\n\n  var registerUser = function registerUser() {\n    var email, password, displayName, user;\n    return _regeneratorRuntime.async(function registerUser$(_context5) {\n      while (1) {\n        switch (_context5.prev = _context5.next) {\n          case 0:\n            Keyboard.dismiss();\n            email = state.email, password = state.password, displayName = state.displayName;\n            _context5.prev = 2;\n            _context5.next = 5;\n            return _regeneratorRuntime.awrap(auth.createUserWithEmailAndPassword(email, password));\n\n          case 5:\n            user = _context5.sent;\n            _context5.next = 8;\n            return _regeneratorRuntime.awrap(uploadAvatar(avatar));\n\n          case 8:\n            _context5.next = 10;\n            return _regeneratorRuntime.awrap(user.user.updateProfile({\n              displayName: displayName,\n              photoURL: \"\" + avatar\n            }));\n\n          case 10:\n            currentUser();\n            _context5.next = 16;\n            break;\n\n          case 13:\n            _context5.prev = 13;\n            _context5.t0 = _context5[\"catch\"](2);\n            setmessage(_context5.t0.message);\n\n          case 16:\n            setState(initialState);\n\n          case 17:\n          case \"end\":\n            return _context5.stop();\n        }\n      }\n    }, null, null, [[2, 13]], Promise);\n  };\n\n  var loginUser = function loginUser() {\n    var email, password, user;\n    return _regeneratorRuntime.async(function loginUser$(_context6) {\n      while (1) {\n        switch (_context6.prev = _context6.next) {\n          case 0:\n            Keyboard.dismiss();\n            email = state.email, password = state.password;\n            _context6.prev = 2;\n            _context6.next = 5;\n            return _regeneratorRuntime.awrap(auth.signInWithEmailAndPassword(email, password));\n\n          case 5:\n            user = _context6.sent;\n            _context6.next = 8;\n            return _regeneratorRuntime.awrap(uploadAvatar(avatar));\n\n          case 8:\n            _context6.next = 10;\n            return _regeneratorRuntime.awrap(user.user.updateProfile({\n              photoURL: \"\" + avatar\n            }));\n\n          case 10:\n            currentUser();\n            _context6.next = 16;\n            break;\n\n          case 13:\n            _context6.prev = 13;\n            _context6.t0 = _context6[\"catch\"](2);\n            setmessage(_context6.t0.message);\n\n          case 16:\n            setState(initialState);\n\n          case 17:\n          case \"end\":\n            return _context6.stop();\n        }\n      }\n    }, null, null, [[2, 13]], Promise);\n  };\n\n  return React.createElement(TouchableWithoutFeedback, {\n    onPress: Keyboard.dismiss,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 106,\n      columnNumber: 5\n    }\n  }, React.createElement(ImageBackground, {\n    source: require(\"../assets/images/road.jpg\"),\n    style: styles.image,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 107,\n      columnNumber: 7\n    }\n  }, React.createElement(KeyboardAvoidingView, {\n    behavior: Platform.Os == \"ios\" ? \"padding\" : \"height\",\n    style: styles.container,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 111,\n      columnNumber: 9\n    }\n  }, React.createElement(View, {\n    style: styles.form,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 115,\n      columnNumber: 11\n    }\n  }, React.createElement(TouchableOpacity, {\n    onPress: takePhoto,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 116,\n      columnNumber: 13\n    }\n  }, React.createElement(Image, {\n    style: {\n      width: 100,\n      height: 100,\n      borderRadius: 50,\n      marginBottom: 30\n    },\n    source: {\n      uri: avatar ? avatar : \"https://tipsmake.com/data/images/top-black-avatar-for-sad-mood-picture-3-FGqyF9V9E.jpg\"\n    },\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 117,\n      columnNumber: 15\n    }\n  })), !isRegister && React.createElement(TextInput, {\n    style: _objectSpread({}, styles.input, {\n      marginBottom: 20\n    }),\n    placeholder: \"enter nickname\",\n    value: state.displayName,\n    onFocus: function onFocus() {\n      return setmessage(null);\n    },\n    onChangeText: function onChangeText(value) {\n      return setState(_objectSpread({}, state, {\n        displayName: value\n      }));\n    },\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 132,\n      columnNumber: 15\n    }\n  }), React.createElement(TextInput, {\n    style: _objectSpread({}, styles.input, {\n      marginBottom: 20\n    }),\n    placeholder: \"enter email\",\n    value: state.email,\n    onFocus: function onFocus() {\n      return setmessage(null);\n    },\n    onChangeText: function onChangeText(value) {\n      return setState(_objectSpread({}, state, {\n        email: value\n      }));\n    },\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 142,\n      columnNumber: 13\n    }\n  }), React.createElement(TextInput, {\n    style: styles.input,\n    placeholder: \"enter password\",\n    secureTextEntry: true,\n    onChangeText: function onChangeText(value) {\n      return setState(_objectSpread({}, state, {\n        password: value\n      }));\n    },\n    value: state.password,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 149,\n      columnNumber: 13\n    }\n  }), message && React.createElement(Text, {\n    style: styles.inputError,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 156,\n      columnNumber: 25\n    }\n  }, message), React.createElement(TouchableOpacity, {\n    style: styles.btn,\n    onPress: isRegister ? loginUser : registerUser,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 157,\n      columnNumber: 13\n    }\n  }, React.createElement(Text, {\n    style: styles.btnTitle,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 161,\n      columnNumber: 15\n    }\n  }, \"Submit\")), React.createElement(View, {\n    style: styles.btnBlock,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 163,\n      columnNumber: 13\n    }\n  }, React.createElement(TouchableOpacity, {\n    style: styles.btn,\n    onPress: isRegister ? function () {\n      return setIsRegister(false);\n    } : function () {\n      return setIsRegister(true);\n    },\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 164,\n      columnNumber: 15\n    }\n  }, React.createElement(Text, {\n    style: styles.btnTitle,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 172,\n      columnNumber: 17\n    }\n  }, !isRegister ? \"go Login\" : \"go Register\")))))));\n};\nvar styles = StyleSheet.create({\n  container: {\n    alignItems: \"center\",\n    justifyContent: \"center\"\n  },\n  image: {\n    flex: 1,\n    resizeMode: \"cover\",\n    justifyContent: \"center\",\n    width: \"100%\"\n  },\n  form: {\n    alignItems: \"center\"\n  },\n  input: {\n    borderColor: \"#556b2f\",\n    borderWidth: 2,\n    borderRadius: 18,\n    width: 300,\n    height: 40,\n    paddingLeft: 40,\n    backgroundColor: \"white\"\n  },\n  inputError: {\n    color: \"#f00\"\n  },\n  btnBlock: {\n    flexDirection: \"row\"\n  },\n  btn: {\n    height: 40,\n    width: 100,\n    backgroundColor: \"#556b2f\",\n    borderRadius: 18,\n    marginTop: 40,\n    justifyContent: \"center\",\n    alignItems: \"center\"\n  },\n  btnTitle: {\n    color: \"white\",\n    fontSize: 18\n  }\n});","map":{"version":3,"sources":["C:/Users/1/Documents/goit_hw/REACT/native_project/global_project/screens/AuthScreen.js"],"names":["React","useState","useEffect","auth","storage","ImagePicker","Permissions","initialState","email","password","displayName","AuthScreen","state","setState","message","setmessage","isRegister","setIsRegister","avatar","setAvatar","getPermissionAsync","currentUser","console","log","askAsync","CAMERA_ROLL","status","alert","uploadAvatar","photo","fetch","response","blob","file","uniqueId","Date","now","toString","ref","put","child","getDownloadURL","url","Alert","takePhoto","launchImageLibraryAsync","mediaTypes","MediaTypeOptions","All","allowsEditing","aspect","quality","result","uri","registerUser","Keyboard","dismiss","createUserWithEmailAndPassword","user","updateProfile","photoURL","loginUser","signInWithEmailAndPassword","require","styles","image","Platform","Os","container","form","width","height","borderRadius","marginBottom","input","value","inputError","btn","btnTitle","btnBlock","StyleSheet","create","alignItems","justifyContent","flex","resizeMode","borderColor","borderWidth","paddingLeft","backgroundColor","color","flexDirection","marginTop","fontSize"],"mappings":"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","sourcesContent":["import React, { useState, useEffect } from \"react\";\nimport {\n  StyleSheet,\n  View,\n  TextInput,\n  TouchableWithoutFeedback,\n  KeyboardAvoidingView,\n  Platform,\n  Keyboard,\n  Image,\n  ImageBackground,\n  TouchableOpacity,\n  Text,\n} from \"react-native\";\nimport { auth, storage } from \"../firebase/config\";\nimport * as ImagePicker from \"expo-image-picker\";\nimport * as Permissions from \"expo-permissions\";\n\nconst initialState = {\n  email: \"\",\n  password: \"\",\n  displayName: \"\",\n};\n\nexport const AuthScreen = () => {\n  const [state, setState] = useState(initialState);\n  const [message, setmessage] = useState(null);\n  const [isRegister, setIsRegister] = useState(false);\n  const [avatar, setAvatar] = useState(\"\");\n\n  useEffect(() => {\n    getPermissionAsync();\n  }, []);\n\n  // useEffect(() => {\n  //   currentUser();\n  // }, []);\n\n  const currentUser = async () => {\n    const currentUser=await auth.currentUser;\n    console.log('currentUser', currentUser);\n  };\n\n  const getPermissionAsync = async () => {\n    const { status } = await Permissions.askAsync(Permissions.CAMERA_ROLL);\n    if (status !== \"granted\") {\n      alert(\"Sorry, we need camera roll permissions to make this work!\");\n    }\n  };\n\n  const uploadAvatar = async (photo) => {\n    if (photo) {\n      const response = await fetch(photo);\n      const file = await response.blob();\n      const uniqueId = Date.now().toString();\n      await storage.ref(`avatar/${uniqueId}`).put(file);\n      const url = await storage.ref(\"avatar\").child(uniqueId).getDownloadURL();\n      setAvatar(url);\n    } else Alert.alert(\"No avatar\");\n  };\n\n  const takePhoto = async () => {\n    let result = await ImagePicker.launchImageLibraryAsync({\n      mediaTypes: ImagePicker.MediaTypeOptions.All,\n      allowsEditing: true,\n      aspect: [4, 3],\n      quality: 1,\n    });\n    setAvatar(result.uri);\n  };\n\n  const registerUser = async () => {\n    Keyboard.dismiss();\n    const { email, password, displayName } = state;\n    try {\n      const user = await auth.createUserWithEmailAndPassword(email, password);\n      await uploadAvatar(avatar);\n      await user.user.updateProfile({\n        displayName: displayName,\n        photoURL: `${avatar}`,\n      });\n      currentUser();\n    } catch (error) {\n      setmessage(error.message);\n    }\n    setState(initialState);\n  };\n\n  const loginUser = async () => {\n    Keyboard.dismiss();\n    const { email, password } = state;\n    try {\n      const user = await auth.signInWithEmailAndPassword(email, password);\n      await uploadAvatar(avatar);\n      await user.user.updateProfile({\n        photoURL: `${avatar}`,\n      });\n      currentUser();\n    } catch (error) {\n      setmessage(error.message);\n    }\n    setState(initialState);\n  };\n\n  return (\n    <TouchableWithoutFeedback onPress={Keyboard.dismiss}>\n      <ImageBackground\n        source={require(\"../assets/images/road.jpg\")}\n        style={styles.image}\n      >\n        <KeyboardAvoidingView\n          behavior={Platform.Os == \"ios\" ? \"padding\" : \"height\"}\n          style={styles.container}\n        >\n          <View style={styles.form}>\n            <TouchableOpacity onPress={takePhoto}>\n              <Image\n                style={{\n                  width: 100,\n                  height: 100,\n                  borderRadius: 50,\n                  marginBottom: 30,\n                }}\n                source={{\n                  uri: avatar\n                    ? avatar\n                    : \"https://tipsmake.com/data/images/top-black-avatar-for-sad-mood-picture-3-FGqyF9V9E.jpg\",\n                }}\n              />\n            </TouchableOpacity>\n            {!isRegister && (\n              <TextInput\n                style={{ ...styles.input, marginBottom: 20 }}\n                placeholder=\"enter nickname\"\n                value={state.displayName}\n                onFocus={() => setmessage(null)}\n                onChangeText={(value) =>\n                  setState({ ...state, displayName: value })\n                }\n              />\n            )}\n            <TextInput\n              style={{ ...styles.input, marginBottom: 20 }}\n              placeholder=\"enter email\"\n              value={state.email}\n              onFocus={() => setmessage(null)}\n              onChangeText={(value) => setState({ ...state, email: value })}\n            />\n            <TextInput\n              style={styles.input}\n              placeholder=\"enter password\"\n              secureTextEntry={true}\n              onChangeText={(value) => setState({ ...state, password: value })}\n              value={state.password}\n            />\n            {message && <Text style={styles.inputError}>{message}</Text>}\n            <TouchableOpacity\n              style={styles.btn}\n              onPress={isRegister ? loginUser : registerUser}\n            >\n              <Text style={styles.btnTitle}>Submit</Text>\n            </TouchableOpacity>\n            <View style={styles.btnBlock}>\n              <TouchableOpacity\n                style={styles.btn}\n                onPress={\n                  isRegister\n                    ? () => setIsRegister(false)\n                    : () => setIsRegister(true)\n                }\n              >\n                <Text style={styles.btnTitle}>\n                  {!isRegister ? \"go Login\" : \"go Register\"}\n                </Text>\n              </TouchableOpacity>\n            </View>\n          </View>\n        </KeyboardAvoidingView>\n      </ImageBackground>\n    </TouchableWithoutFeedback>\n  );\n};\n\nconst styles = StyleSheet.create({\n  container: {\n    alignItems: \"center\",\n    justifyContent: \"center\",\n  },\n  image: {\n    flex: 1,\n    resizeMode: \"cover\",\n    justifyContent: \"center\",\n    width: \"100%\",\n  },\n  form: {\n    alignItems: \"center\",\n  },\n  input: {\n    borderColor: \"#556b2f\",\n    borderWidth: 2,\n    borderRadius: 18,\n    width: 300,\n    height: 40,\n    paddingLeft: 40,\n    backgroundColor: \"white\",\n  },\n  inputError: { color: \"#f00\" },\n  btnBlock: {\n    flexDirection: \"row\",\n  },\n  btn: {\n    height: 40,\n    width: 100,\n    backgroundColor: \"#556b2f\",\n    borderRadius: 18,\n    marginTop: 40,\n    justifyContent: \"center\",\n    alignItems: \"center\",\n  },\n  btnTitle: {\n    color: \"white\",\n    fontSize: 18,\n  },\n});\n"]},"metadata":{},"sourceType":"module"}