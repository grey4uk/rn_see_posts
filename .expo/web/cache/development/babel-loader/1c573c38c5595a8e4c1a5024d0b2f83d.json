{"ast":null,"code":"import _regeneratorRuntime from \"@babel/runtime/regenerator\";\nimport _slicedToArray from \"@babel/runtime/helpers/slicedToArray\";\nvar _jsxFileName = \"C:\\\\Users\\\\1\\\\Documents\\\\goit_hw\\\\REACT\\\\native_project\\\\global_project\\\\screens\\\\tab\\\\MainScreen.js\";\nimport React, { useEffect, useState } from \"react\";\nimport StyleSheet from \"react-native-web/dist/exports/StyleSheet\";\nimport Text from \"react-native-web/dist/exports/Text\";\nimport View from \"react-native-web/dist/exports/View\";\nimport Button from \"react-native-web/dist/exports/Button\";\nimport FlatList from \"react-native-web/dist/exports/FlatList\";\nimport Image from \"react-native-web/dist/exports/Image\";\nimport { useDispatch, useSelector } from \"react-redux\";\nimport { auth, firestore } from \"../../firebase/config\";\nexport var MainScreen = function MainScreen() {\n  var dispatch = useDispatch();\n\n  var _useSelector = useSelector(function (state) {\n    return state.user;\n  }),\n      userId = _useSelector.userId,\n      userPosts = _useSelector.userPosts;\n\n  var _useState = useState([]),\n      _useState2 = _slicedToArray(_useState, 2),\n      allPosts = _useState2[0],\n      setAllPosts = _useState2[1];\n\n  useEffect(function () {\n    currentUser();\n  }, []);\n  useEffect(function () {\n    getCollection();\n  }, []);\n\n  var currentUser = function currentUser() {\n    var currentUser;\n    return _regeneratorRuntime.async(function currentUser$(_context) {\n      while (1) {\n        switch (_context.prev = _context.next) {\n          case 0:\n            _context.next = 2;\n            return _regeneratorRuntime.awrap(auth.currentUser);\n\n          case 2:\n            currentUser = _context.sent;\n            dispatch({\n              type: \"CURRENT_USER\",\n              payload: {\n                userName: currentUser.displayName,\n                userId: currentUser.uid\n              }\n            });\n\n          case 4:\n          case \"end\":\n            return _context.stop();\n        }\n      }\n    }, null, null, null, Promise);\n  };\n\n  var signOut = function signOut() {\n    return _regeneratorRuntime.async(function signOut$(_context2) {\n      while (1) {\n        switch (_context2.prev = _context2.next) {\n          case 0:\n            _context2.next = 2;\n            return _regeneratorRuntime.awrap(auth.signOut());\n\n          case 2:\n            dispatch({\n              type: \"USER_SIGNOUT\"\n            });\n\n          case 3:\n          case \"end\":\n            return _context2.stop();\n        }\n      }\n    }, null, null, null, Promise);\n  };\n\n  var getCollection = function getCollection() {\n    return _regeneratorRuntime.async(function getCollection$(_context3) {\n      while (1) {\n        switch (_context3.prev = _context3.next) {\n          case 0:\n            _context3.next = 2;\n            return _regeneratorRuntime.awrap(firestore.collection(\"posts\").where(\"userId\", \"==\", userId).onSnapshot(function (data) {\n              return setAllPosts(data.docs.map(function (doc) {\n                return doc.data();\n              }));\n            }));\n\n          case 2:\n          case \"end\":\n            return _context3.stop();\n        }\n      }\n    }, null, null, null, Promise);\n  };\n\n  console.log(\"allPosts\", allPosts);\n  return React.createElement(View, {\n    style: styles.container,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 56,\n      columnNumber: 7\n    }\n  }, React.createElement(Text, {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 57,\n      columnNumber: 9\n    }\n  }, \"hello\"), React.createElement(Button, {\n    title: \"logOut\",\n    onPress: signOut,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 58,\n      columnNumber: 9\n    }\n  }), React.createElement(FlatList, {\n    data: allPosts,\n    keyExtractor: function keyExtractor(item) {\n      return item.userId;\n    },\n    renderItem: function renderItem(_ref) {\n      var item = _ref.item;\n      console.log(\"post\", item);\n      return React.createElement(Image, {\n        style: {\n          width: 350,\n          height: 200,\n          marginBottom: 10,\n          borderRadius: 10\n        },\n        source: {\n          uri: item.image\n        },\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 65,\n          columnNumber: 15\n        }\n      });\n    },\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 59,\n      columnNumber: 9\n    }\n  }));\n};\nvar styles = StyleSheet.create({\n  container: {\n    flex: 1,\n    backgroundColor: \"#fff\",\n    alignItems: \"center\",\n    justifyContent: \"center\"\n  }\n});","map":{"version":3,"sources":["C:/Users/1/Documents/goit_hw/REACT/native_project/global_project/screens/tab/MainScreen.js"],"names":["React","useEffect","useState","useDispatch","useSelector","auth","firestore","MainScreen","dispatch","state","user","userId","userPosts","allPosts","setAllPosts","currentUser","getCollection","type","payload","userName","displayName","uid","signOut","collection","where","onSnapshot","data","docs","map","doc","console","log","styles","container","item","width","height","marginBottom","borderRadius","uri","image","StyleSheet","create","flex","backgroundColor","alignItems","justifyContent"],"mappings":"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","sourcesContent":["  import React, { useEffect, useState } from \"react\";\n  import { StyleSheet, Text, View, Button, FlatList, Image } from \"react-native\";\n  import { useDispatch, useSelector } from \"react-redux\";\n  import { auth, firestore } from \"../../firebase/config\";\n  \n  export const MainScreen = () => {\n    const dispatch = useDispatch();\n  \n    const { userId, userPosts } = useSelector((state) => state.user);\n    const [allPosts, setAllPosts] = useState([]);\n  \n    useEffect(() => {\n      currentUser();\n    }, []);\n  \n    useEffect(() => {\n      getCollection();\n    }, []);\n  \n    const currentUser = async () => {\n      const currentUser = await auth.currentUser;\n      // const querySnapshot = await firestore\n      //   .collection(\"posts\")\n      //   .where(\"userId\", \"==\", userId)\n      //   .get();\n  \n      // const posts = querySnapshot.docs.map((doc) => doc.data());\n      // console.log(\"posts\", posts);\n      dispatch({\n        type: \"CURRENT_USER\",\n        payload: {\n          userName: currentUser.displayName,\n          userId: currentUser.uid,\n        },\n      });\n    };\n  \n    const signOut = async () => {\n      await auth.signOut();\n      dispatch({ type: \"USER_SIGNOUT\" });\n    };\n  \n    const getCollection = async () => {\n      await firestore\n        .collection(\"posts\")\n        .where(\"userId\", \"==\", userId)\n        .onSnapshot((data) => setAllPosts(data.docs.map((doc) => doc.data())));\n      // console.log(\"data\", data);\n      // const posts = querySnapshot.docs.map((doc) => doc.data());\n      // console.log(\"posts\", posts);\n    };\n  \n    console.log(\"allPosts\", allPosts);\n  \n    return (\n      <View style={styles.container}>\n        <Text>hello</Text>\n        <Button title=\"logOut\" onPress={signOut} />\n        <FlatList\n          data={allPosts}\n          keyExtractor={(item) => item.userId}\n          renderItem={({ item }) => {\n            console.log(\"post\", item);\n            return (\n              <Image\n                style={{\n                  width: 350,\n                  height: 200,\n                  marginBottom: 10,\n                  borderRadius: 10,\n                }}\n                source={{ uri: item.image }}\n              />\n            );\n          }}\n        />\n      </View>\n    );\n  };\n  \n  const styles = StyleSheet.create({\n    container: {\n      flex: 1,\n      backgroundColor: \"#fff\",\n      alignItems: \"center\",\n      justifyContent: \"center\",\n    },\n  });"]},"metadata":{},"sourceType":"module"}